{% extends 'base.html' %}

{% block content %}
<!-- –ë–ê–ù–ù–ï–†–´ -->
<section class="banner-section">
  <div class="banner-grid">
    <div class="banner">
      <h3>üéâ –°–∫–∏–¥–∫–∞ 50%</h3>
      <p>–ù–∞ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</p>
    </div>
    <div class="banner">
      <h3>üöÄ –ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</h3>
      <p>–ó–∞ 24 —á–∞—Å–∞ –ø–æ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–µ</p>
    </div>
    <div class="banner">
      <h3>üíù –ë–æ–Ω—É—Å—ã –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º</h3>
      <p>–ü–æ–ª—É—á–∞–π—Ç–µ –∫–µ—à–±—ç–∫ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–∞—Ö</p>
    </div>
  </div>
</section>

<!-- –¢–û–í–ê–†–´ -->
<section class="products-section">
  <h2>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</h2>
  
  {% if products %}
    <div class="products-grid">
      {% for product in products %}
        <div class="product-card">
          <div class="product-image">
            {% if product.image %}
              <a href="{% url 'product_detail' slug=product.slug %}">
                <img src="{{ product.image.url }}" alt="{{ product.name }}" loading="lazy">
              </a>
            {% else %}
              <a href="{% url 'product_detail' slug=product.slug %}" style="color: var(--muted); text-decoration: none;">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</a>
            {% endif %}
            {% if user.is_authenticated %}
              {% if product.id in favorites_set %}
                <form method="post" action="{% url 'fav_remove' product.id %}" style="display:inline">
                  {% csrf_token %}
                  <button type="submit" class="product-fav" title="–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ">‚ù§Ô∏è</button>
                </form>
              {% else %}
                <form method="post" action="{% url 'fav_add' product.id %}" style="display:inline">
                  {% csrf_token %}
                  <button type="submit" class="product-fav" title="–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ">ü§ç</button>
                </form>
              {% endif %}
            {% else %}
              <a href="{% url 'login' %}" class="product-fav" title="–í–æ–π—Ç–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ">ü§ç</a>
            {% endif %}
          </div>
          
          <div class="product-info">
            <div class="product-rating">
              <span class="star">‚òÖ</span>
              <span>4.5 (120 –æ—Ç–∑—ã–≤–æ–≤)</span>
            </div>
            
            <a href="{% url 'product_detail' slug=product.slug %}" class="product-name" style="text-decoration: none; color: inherit;">
              {% if language == 'kg' and product.name_kg %}
                {{ product.name_kg }}
              {% elif language == 'ru' and product.name_ru %}
                {{ product.name_ru }}
              {% elif language == 'en' and product.name_en %}
                {{ product.name_en }}
              {% else %}
                {{ product.name }}
              {% endif %}
            </a>
            
            <div class="product-price">{{ product.price }} ‚ÇΩ</div>
            
            <div class="product-action">
              <form method="post" action="{% url 'cart_add' product.id %}" style="flex:1">
                {% csrf_token %}
                <button type="submit" class="add-btn">üõí –í –∫–æ—Ä–∑–∏–Ω—É</button>
              </form>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p style="text-align: center; color: var(--muted); padding: 40px;">
      –¢–æ–≤–∞—Ä—ã –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã. <a href="{% url 'add_product' %}">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</a>
    </p>
  {% endif %}
</section>

<!-- CTA –°–ï–ö–¶–ò–Ø -->
<section style="margin-top: 40px; text-align: center; padding: 40px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; color: white;">
  <h2>–•–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–∞–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã?</h2>
  <p style="margin: 12px 0; font-size: 1.1rem;">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç–µ—Å—å –∫ –Ω–∞—à–µ–º—É –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—É</p>
  <a href="{% url 'add_product' %}" class="mc-btn" style="background: white; color: #667eea; font-weight: 700;">–ù–∞—á–∞—Ç—å –ø—Ä–æ–¥–∞–≤–∞—Ç—å</a>
</section>

{% endblock %}
